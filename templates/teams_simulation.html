<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Teams Simulation | Done & Dusted</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* THEME COPIED FROM INDEX.HTML */
        :root { --bg: #0a0a0a; --card: #161616; --cyan: #00f2ff; --purple: #bc13fe; --high: #ff4d4d; --upcoming: #ffa500; }
        
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: white; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Layout */
        .sidebar { width: 280px; background: #0d0d0d; border-right: 1px solid #222; display: flex; flex-direction: column; }
        .main-chat { flex: 1; display: flex; flex-direction: column; background: var(--bg); }
        
        /* Task Cards (Same as Personal) */
        .feed { flex: 1; overflow-y: auto; padding: 40px; max-width: 900px; margin: auto; width: 100%; box-sizing: border-box; }
        .task-card { background: var(--card); border-radius: 18px; padding: 22px; margin-bottom: 18px; border: 1px solid #222; display: flex; justify-content: space-between; align-items: center; transition: 0.3s ease; position: relative; }
        .task-card.greyed { opacity: 0.4; filter: grayscale(1); }
        
        .category-pill { display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 10px; font-weight: 800; text-transform: uppercase; margin-bottom: 8px; color: #000; background: var(--cyan); }
        .task-info { flex: 1; padding-right: 20px; }
        .task-title { font-weight: 700; font-size: 18px; margin-bottom: 5px; display: block; }
        .task-desc { font-size: 13px; color: #888; margin-bottom: 10px; }
        .meta-row { font-size: 11px; color: #555; display: flex; gap: 15px; align-items: center; }
        .team-meta { color: var(--purple); font-weight: bold; }

        /* Checkbox (Same as Personal) */
        .cb-wrapper { cursor: pointer; width: 28px; height: 28px; position: relative; display: inline-block; }
        .cb-wrapper input { opacity: 0; width: 0; height: 0; position: absolute; }
        .checkmark { position: absolute; top: 0; left: 0; height: 28px; width: 28px; background: #222; border-radius: 8px; border: 2px solid var(--cyan); transition: 0.2s; }
        .cb-wrapper input:checked ~ .checkmark { background: var(--cyan); }
        .checkmark:after { content: ""; position: absolute; display: none; left: 9px; top: 5px; width: 6px; height: 12px; border: solid black; border-width: 0 3px 3px 0; transform: rotate(45deg); }
        .cb-wrapper input:checked ~ .checkmark:after { display: block; }
        .cb-wrapper input:disabled ~ .checkmark { border-color: #444; opacity: 0.3; cursor: not-allowed; }

        /* Modal & Form (Same as Personal) */
        .modal { display: none; position: fixed; z-index: 200; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); align-items: center; justify-content: center; }
        .modal-content { background: var(--card); padding: 35px; border-radius: 24px; width: 420px; border: 1px solid #333; }
        .t-input { background: #1a1a1a; border: 1px solid #333; color: white; padding: 12px; border-radius: 10px; outline: none; font-family: inherit; font-size: 13px; width: 100%; box-sizing: border-box; margin-bottom: 15px; }
        .field-label { display: block; font-size: 11px; color: var(--cyan); font-weight: 800; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 1px; }

        /* Sidebar Items */
        .team-item { padding: 15px 20px; border-radius: 12px; margin: 5px 10px; cursor: pointer; transition: 0.3s; font-weight: 600; font-size: 14px; }
        .team-item:hover { background: #1a1a1a; }
        .team-item.active { background: rgba(0, 242, 255, 0.1); color: var(--cyan); border-left: 4px solid var(--cyan); }

        .fab { position: fixed; bottom: 35px; right: 35px; width: 65px; height: 65px; background: var(--cyan); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 35px; color: black; cursor: pointer; border: none; z-index: 150; box-shadow: 0 0 20px rgba(0, 242, 255, 0.3); }
    </style>
</head>
<body>

    <div class="sidebar">
        <div style="padding: 30px 20px; border-bottom: 1px solid #222;">
            <div style="color: var(--cyan); font-weight: 800; font-size: 12px; letter-spacing: 2px;">DONE & DUSTED</div>
            <div style="font-size: 18px; font-weight: 800; margin-top: 5px;">TEAMS</div>
        </div>
        <div style="padding: 15px 20px;">
            <button class="t-input" style="background: var(--purple); border: none; font-weight: 800;" onclick="location.reload()">BACK TO PERSONAL</button>
        </div>
        <div id="teamList"></div>
    </div>

    <div class="main-chat">
        <div style="padding: 25px 40px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center;">
            <h2 id="currentTeamName" style="margin:0; font-weight: 800;">Select Team</h2>
            <div style="font-size: 11px; color: var(--cyan); font-weight: 800;" id="teamModeDisplay"></div>
        </div>

        <div id="feedArea" class="feed"></div>
    </div>

    <button class="fab" onclick="openAddModal()">+</button>

    <div id="taskModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle" style="margin-top:0; font-weight: 800;">Add Team Task</h2>
            <form id="taskForm">
                <label class="field-label">Task Title</label>
                <input type="text" id="fTitle" class="t-input" placeholder="What needs doing?" required>
                
                <label class="field-label">Description</label>
                <textarea id="fDesc" class="t-input" style="height: 80px;"></textarea>
                
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label class="field-label">Priority</label>
                        <select id="fPriority" class="t-input">
                            <option value="Low">Low</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="High">High</option>
                        </select>
                    </div>
                    <div>
                        <label class="field-label">Category</label>
                        <input type="text" id="fCat" class="t-input" placeholder="General">
                    </div>
                </div>

                <label class="field-label">Due Date & Time</label>
                <input type="datetime-local" id="fDue" class="t-input">

                <label class="field-label" style="color: var(--purple);">Assign To Member</label>
                <select id="fAssignee" class="t-input" style="border-color: var(--purple);">
                    <option value="">Unassigned (Anyone can Dust)</option>
                </select>

                <div style="display:flex; gap:10px; margin-top:10px;">
                    <button type="button" class="t-input" style="background:#222; border:none;" onclick="closeModal()">Cancel</button>
                    <button type="button" class="t-input" style="background:var(--cyan); color:black; border:none; font-weight:800;" onclick="addTask()">ADD TO FEED</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const currentUser = "DevUser";
        let mockTeams = [
            { id: 1, name: "Marketing Crew", mode: "Admin", members: ["DevUser", "Alice", "Bob"] },
            { id: 2, name: "Design Feedback", mode: "Democratic", members: ["DevUser", "Alice"] }
        ];

        let mockTasks = JSON.parse(localStorage.getItem('simTasks')) || [
            { id: 1, teamId: 1, creator: "Alice", title: "Update Brand Guide", desc: "Use the new purple hex code", priority: "High", cat: "Design", due: "2024-06-21T15:00", assignee: "DevUser", completed: false }
        ];

        let activeId = 1;

        function init() {
            renderSidebar();
            loadTeam(1);
        }

        function renderSidebar() {
            document.getElementById('teamList').innerHTML = mockTeams.map(t => `
                <div class="team-item ${t.id === activeId ? 'active' : ''}" onclick="loadTeam(${t.id})">
                    ${t.name}
                </div>
            `).join('');
        }

        function loadTeam(id) {
            activeId = id;
            const team = mockTeams.find(t => t.id === id);
            document.getElementById('currentTeamName').innerText = team.name;
            document.getElementById('teamModeDisplay').innerText = team.mode.toUpperCase() + " MODE";
            
            // Assignee dropdown
            const sel = document.getElementById('fAssignee');
            sel.innerHTML = '<option value="">Unassigned (Anyone can Dust)</option>' + 
                team.members.map(m => `<option value="${m}">${m}</option>`).join('');

            renderSidebar();
            renderFeed();
        }

        function renderFeed() {
            const feed = document.getElementById('feedArea');
            const tasks = mockTasks.filter(t => t.teamId === activeId);
            
            feed.innerHTML = tasks.map(t => {
                const isLocked = t.assignee && t.assignee !== currentUser;
                return `
                <div class="task-card ${t.completed ? 'greyed' : ''}">
                    <div class="task-info">
                        <span class="category-pill">${t.cat || 'General'}</span>
                        <span class="task-title">${t.title}</span>
                        <div class="task-desc">${t.desc}</div>
                        <div class="meta-row">
                            <span style="color:${t.priority === 'High' ? 'var(--high)' : '#888'}">‚óè ${t.priority}</span>
                            <span>üìÖ ${t.due ? t.due.replace('T', ' ') : 'No Date'}</span>
                            <span class="team-meta">üë§ Added by: ${t.creator}</span>
                            ${t.assignee ? `<span style="color:var(--cyan)">üéØ Assigned to: @${t.assignee}</span>` : ''}
                        </div>
                    </div>
                    <div class="task-actions">
                        <label class="cb-wrapper">
                            <input type="checkbox" ${t.completed ? 'checked disabled' : ''} 
                                   ${isLocked ? 'disabled' : ''} 
                                   onchange="dustTask(${t.id})">
                            <span class="checkmark" ${isLocked ? 'style="border-color:#444"' : ''}></span>
                        </label>
                    </div>
                </div>`;
            }).join('');
        }

        function dustTask(id) {
            const t = mockTasks.find(x => x.id === id);
            t.completed = true;
            localStorage.setItem('simTasks', JSON.stringify(mockTasks));
            setTimeout(renderFeed, 500);
        }

        function openAddModal() { document.getElementById('taskModal').style.display = 'flex'; }
        function closeModal() { document.getElementById('taskModal').style.display = 'none'; }

        function addTask() {
            const newTask = {
                id: Date.now(),
                teamId: activeId,
                creator: currentUser,
                title: document.getElementById('fTitle').value,
                desc: document.getElementById('fDesc').value,
                priority: document.getElementById('fPriority').value,
                cat: document.getElementById('fCat').value,
                due: document.getElementById('fDue').value,
                assignee: document.getElementById('fAssignee').value,
                completed: false
            };
            mockTasks.push(newTask);
            localStorage.setItem('simTasks', JSON.stringify(mockTasks));
            closeModal();
            renderFeed();
        }

        init();
    </script>
</body>
</html>